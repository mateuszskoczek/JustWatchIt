@layout MainLayout

@page "/lists/movies"
@using WatchIt.Common.Model.Movies

<div class="container-grid">
    @if (_loaded)
    {
        if (string.IsNullOrWhiteSpace(_error))
        {
            <div class="row">
                <div class="col">
                    <div class="rounded-3 panel panel-regular p-2">
                        <div class="container-grid">
                            <div class="row">
                                <div class="col">
                                    <h3 class="m-0">Movies database</h3>
                                </div>
                                <div class="col-auto">
                            
                                </div>
                                <div class="col-auto">

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            foreach (MovieResponse item in _items)
            {
                <div class="row mt-3">
                    <div class="col">
                        <a class="text-reset text-decoration-none" href="/media/@(item.Id)">
                            <div class="rounded-3 panel panel-regular p-2">
                                <ListItemComponent Id="@(item.Id)"
                                                   Name="@(item.Title)"
                                                   AdditionalNameInfo="@(item.ReleaseDate.HasValue ? $" ({item.ReleaseDate.Value.Year})" : null)"
                                                   Rating="@(item.Rating)"
                                                   PictureDownloadingTask="@((id, action) => MediaWebAPIService.GetMediaPoster(id, action))"/>
                            </div>
                        </a>
                    </div>
                </div>
            }
            if (!_allItemsLoaded)
            {
                <div class="row mt-3">
                    <div class="col">
                        <div role="button" class="rounded-3 panel panel-regular p-3" @onclick="DownloadItems">
                            <div class="d-flex justify-content-center">
                                @if (!_itemsLoading)
                                {
                                    <strong>Load more</strong>
                                }
                                else
                                {
                                    <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                    <strong>Load more</strong>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            <div class="row">
                <div class="col">
                    <ErrorComponent ErrorMessage="@_error"/>
                </div>
            </div>
        }
    }
    else
    {
        <div class="row">
            <div class="col">
                <div class="m-5">
                    <LoadingComponent/>
                </div>
            </div>
        </div>
    }
</div>

    